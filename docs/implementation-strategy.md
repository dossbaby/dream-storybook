# 점AI (jeom.ai) 구현 전략
## 태그 시스템 + pSEO + 결제 통합 마스터 플랜

> 최종 업데이트: 2025년 12월 6일 (v5 - 리브랜딩 + 모바일 최적화 계획)
>
> **브랜드 변경**: Dream Storybook → 점AI (jeom.ai)

---

## 진행 상황 (Progress Tracker)

### Phase 0: AI Tier System ✅ 완료 (v4 - 3티어)
| 작업 | 상태 | 비고 |
|------|------|------|
| 3티어 시스템 설계 | ✅ 완료 | 무료/프리미엄/울트라 |
| 텍스트 AI 설정 | ✅ 완료 | Free/Premium: Sonnet 4.5, Ultra: Opus 4.5 |
| 이미지 AI 설정 | ✅ 완료 | Free: Flash, Premium/Ultra: Gemini 3 Pro |
| 이미지 설정 추가 | ✅ 완료 | IMAGE_CONFIG (16:9 리딩, 1:1 내보내기) |
| 프리미엄 차별화 | ✅ 완료 | 기능 해금 (Hidden Insight, 심층 분석) |
| 울트라 차별화 | ✅ 완료 | AI 품질 업그레이드 (소름돋는 통찰) |
| TIER_LIMITS 설정 | ✅ 완료 | 무료 하루 1회, 유료 무제한 |
| 가격 설정 | ✅ 완료 | 프리미엄 ₩6,900, 울트라 ₩9,900 |
| PremiumModal 3티어 UI | ✅ 완료 | 플랜 탭 + 감성적 문구 |

### Phase 1: 기반 작업 ✅ 완료
| 작업 | 상태 | 비고 |
|------|------|------|
| [P1-1] 타로 결과창 하단 뒤로가기/다른질문 버튼 제거 | ✅ 완료 | TarotResultView.jsx |
| [P1-2] 명조 폰트 → 리디바탕 전체 변경 | ✅ 완료 | Nanum Myeongjo → RIDIBatang |
| [P1-3] fortune → saju 네이밍 전체 변경 | ✅ 완료 | 라우팅, Firebase, seoConfig |

### Phase 2: 통합 공개 설정 ✅ 완료
| 작업 | 상태 | 비고 |
|------|------|------|
| VisibilitySelector 컴포넌트 생성 | ✅ 완료 | 3단계: private/unlisted/public |
| 저장 로직에 visibility 연동 | ✅ 완료 | useFirebaseSave.js 수정, 레거시 호환 |
| 푸터 연도 동적 처리 | ✅ 완료 | 2025 하드코딩 → new Date().getFullYear() |
| 마이페이지 공개 설정 통합 | ✅ 완료 | VisibilityDropdown UI, 꿈/타로/사주 모두 지원 |

### Phase 3: 태그 시스템 ✅ 완료
| 작업 | 상태 | 비고 |
|------|------|------|
| keywords → tags 정규화 로직 | ✅ 완료 | tagUtils.js (normalizeTag, hasTag, getTagUrl) |
| 키워드 클릭 → /tag/{tagName} | ✅ 완료 | FeedView.jsx에서 navigateToTagPage 구현 |
| TagPage.jsx 생성 | ✅ 완료 | 꿈/타로/사주 통합 태그 페이지 |
| 타입별 필터 탭 | ✅ 완료 | 전체/꿈/타로/사주 필터링 |
| 관련 태그 표시 | ✅ 완료 | 동일 콘텐츠에서 추출한 관련 태그 |
| TagPage CSS | ✅ 완료 | seo-pages.css에 스타일 추가 |

### Phase 4: pSEO 강화 ✅ 완료
| 작업 | 상태 | 비고 |
|------|------|------|
| TagPage SEO 메타데이터 강화 | ✅ 완료 | 풍부한 description, keywords, url |
| /tags 전체 태그 탐색 페이지 | ✅ 완료 | TagsPage.jsx + 통계/정렬/필터 |
| 동적 sitemap 생성기 | ✅ 완료 | sitemapGenerator.js |
| robots.txt 생성기 | ✅ 완료 | sitemapGenerator.js |

### Phase 5: 결제 시스템 ✅ 완료
| 작업 | 상태 | 비고 |
|------|------|------|
| PremiumModal.jsx 생성 | ✅ 완료 | 티어 비교 + 가격 UI |
| useUsageLimit.js 훅 | ✅ 완료 | 일일 사용량 추적 |
| PremiumBadge 컴포넌트 | ✅ 완료 | 배지/블러/잠금 UI |
| paymentConfig.js | ✅ 완료 | 토스페이먼츠 설정 |
| premium.css 스타일 | ✅ 완료 | 모달/배지/블러 스타일 |
| App.jsx 연동 | ✅ 완료 | 프리미엄 모달 + 사용량 훅 연동 |
| NavBar 프리미엄 배지 | ✅ 완료 | 네비게이션에 배지 표시 |

### Phase 6: 데이터 마이그레이션 ⏳ 대기
| 작업 | 상태 | 비고 |
|------|------|------|
| fortunes → saju 컬렉션 마이그레이션 | ⏳ 대기 | Firebase 스크립트 |
| keywords → tags 변환 스크립트 | ⏳ 대기 | 정규화 로직 적용 |
| isPublic → visibility 마이그레이션 | ⏳ 대기 | private/unlisted/public |
| /fortune/* → /saju/* 리다이렉트 | ⏳ 대기 | 301 리다이렉트 |
| sitemap 재생성 | ⏳ 대기 | 마이그레이션 후 |

### Phase 7: 티어 고도화 ✅ 완료
| 작업 | 상태 | 비고 |
|------|------|------|
| Hidden Insight 프리미엄 잠금 | ✅ 완료 | 타로/사주 결과뷰에 적용 |
| 심층 분석 프리미엄 잠금 | ✅ 완료 | DreamDetail, StoryCard, ResultView 적용 |
| useAuth 3티어 시스템 | ✅ 완료 | tier/isPremium/isUltra + Firestore 연동 |
| useReading tier 연동 | ✅ 완료 | 티어별 AI 모델 분기 적용 |
| 사용량 제한 "주 3회"로 변경 | ✅ 완료 | useUsageLimit 주간 시스템 전환 |
| 리딩 히스토리 제한 | ✅ 완료 | 무료 3개 / 프리미엄 무제한 (MyPage 적용) |
| 익명 공유 인센티브 | ✅ 완료 | 공유 시 주 1회 무료 리딩 +1 부여 |
| 맞춤 질문 기능 | ✅ 완료 | 무료: 프리셋 선택, 프리미엄: 자유 입력 |
| 패턴 분석 기능 | ✅ 완료 | 무료: 기본 통계, 프리미엄: 전체 + AI 인사이트 |
| 사주 궁합/연간운세 | ✅ 완료 | 프리미엄 전용 UI + 궁합 입력 폼 |

### Phase 7.5: 리브랜딩 ✅ 완료
| 작업 | 상태 | 비고 |
|------|------|------|
| 도메인 구매 및 연동 | ✅ 완료 | jeom.ai (Porkbun → Vercel) |
| 브랜드명 변경 | ✅ 완료 | 드림북 → 점AI |
| 로고 이모지 변경 | ✅ 완료 | ✨ → 🔮 (수정구슬) |
| 로고 애니메이션 개선 | ✅ 완료 | crystalFloat + crystalPulse |
| index.html 메타태그 | ✅ 완료 | title, OG, favicon |
| SEO 파일 업데이트 | ✅ 완료 | SEOHead, seoConfig, sitemapGenerator |
| 공유 텍스트 업데이트 | ✅ 완료 | ShareModal, cardHelpers |
| robots.txt 업데이트 | ✅ 완료 | sitemap URL 변경 |
| package.json 업데이트 | ✅ 완료 | name, homepage |

### Phase 8: 그로스 ⏳ 대기
| 작업 | 상태 | 비고 |
|------|------|------|
| 알림/리마인더 시스템 | ⏳ 대기 | 아침 푸시 알림 |
| 레퍼럴 프로그램 | ⏳ 대기 | 친구 초대 → 무료 리딩 |
| 온보딩 플로우 개선 | ⏳ 대기 | 첫 경험 가이드 |
| 시즌 이벤트 시스템 | ⏳ 대기 | 설날/발렌타인 등 |
| 영어 확장 준비 | ⏳ 대기 | i18n 기반 작업 |

### Phase 9: 프롬프트 캐싱 (비용 최적화) ⏳ 대기

> ⚠️ **필수 참고 문서:**
> - `docs/claude-caching-guide.md` - Claude 캐싱 공식 가이드
> - `docs/gemini-caching-guide.md` - Gemini 캐싱 공식 가이드
>
> 위 문서를 반드시 참고하여 최적의 캐싱 전략으로 구현할 것!

| 작업 | 상태 | 비고 |
|------|------|------|
| Claude 시스템 프롬프트 캐싱 적용 | ⏳ 대기 | cache_control + ephemeral type |
| Gemini implicit 캐싱 확인 | ⏳ 대기 | 2.5+ 모델 자동 적용 확인 |
| 캐싱 효과 모니터링 로직 | ⏳ 대기 | cache_read_input_tokens 추적 |
| 비용 절감 분석 리포트 | ⏳ 대기 | 캐시 히트율 측정 |

### Phase 10: 모바일 최적화 🔥 최우선
> **벤치마크: 토스 앱** - 직관적이고 편리한 모바일 경험
> 대다수 사용자가 모바일로 접속할 것으로 예상되므로 모바일 친화적 UI/UX는 필수

| 작업 | 상태 | 비고 |
|------|------|------|
| **1. 현황 분석 및 기반 세팅** | | |
| viewport meta 최적화 | ⏳ 대기 | touch-action, user-scalable 설정 |
| CSS 변수 기반 반응형 시스템 | ⏳ 대기 | --mobile-*, --tablet-* 변수 |
| 브레이크포인트 표준화 | ⏳ 대기 | 640px(mobile), 768px(tablet), 1024px(desktop) |
| **2. 레이아웃 재구성** | | |
| 모바일 전용 레이아웃 | ⏳ 대기 | 3단 → 단일 컬럼 (mobile-first) |
| 사이드바 → 바텀시트/드로어 | ⏳ 대기 | 좌측 피드 바텀시트로 변경 |
| 네비게이션 바 최적화 | ⏳ 대기 | 모드 탭 가로 스크롤, 햄버거 메뉴 |
| 바텀 네비게이션 추가 | ⏳ 대기 | 홈/리딩/마이페이지 하단 고정 |
| **3. 터치 최적화** | | |
| 터치 타겟 44px 이상 | ⏳ 대기 | 모든 클릭 요소 최소 크기 |
| 스와이프 제스처 | ⏳ 대기 | 카드 넘기기, 바텀시트 드래그 |
| 터치 피드백 (haptic) | ⏳ 대기 | 버튼 탭 시 시각/촉각 피드백 |
| hover 상태 제거 | ⏳ 대기 | @media (hover: none) 처리 |
| **4. 컴포넌트별 최적화** | | |
| 카드 뷰어 풀스크린 | ⏳ 대기 | 9:16 카드 모바일 전체 화면 |
| 모달 → 풀스크린 시트 | ⏳ 대기 | 모달 대신 슬라이드업 시트 |
| 입력 폼 최적화 | ⏳ 대기 | 키보드 대응, inputmode 설정 |
| 이미지 lazy loading | ⏳ 대기 | IntersectionObserver 적용 |
| **5. 성능 최적화** | | |
| 번들 사이즈 최적화 | ⏳ 대기 | code splitting, tree shaking |
| 이미지 최적화 | ⏳ 대기 | WebP, srcset, sizes |
| 폰트 최적화 | ⏳ 대기 | font-display: swap, preload |
| Skeleton UI | ⏳ 대기 | 로딩 상태 UX 개선 |
| **6. PWA 기능** | | |
| manifest.json | ⏳ 대기 | 앱 아이콘, 스플래시 |
| Service Worker | ⏳ 대기 | 오프라인 지원, 캐싱 |
| 홈 화면 추가 유도 | ⏳ 대기 | A2HS 배너 |

### Phase 11: 피드백 시스템 ⏳ 대기
> 사용자 피드백을 통한 서비스 개선 + 인센티브 기반 참여 유도

| 작업 | 상태 | 비고 |
|------|------|------|
| **1. 피드백 모달 UI** | | |
| FeedbackModal.jsx 컴포넌트 | ⏳ 대기 | 깔끔한 모달 UI |
| 피드백 유형 선택 | ⏳ 대기 | 버그/제안/칭찬/기타 프리셋 |
| 내용 입력 textarea | ⏳ 대기 | 최소 20자, 최대 1000자 |
| 스크린샷 첨부 (선택) | ⏳ 대기 | 이미지 업로드 옵션 |
| **2. 이메일 전송** | | |
| 이메일 Subject 프리셋 | ⏳ 대기 | `[점AI 피드백] {유형} - {userId}` |
| hello@jeom.ai 전송 | ⏳ 대기 | EmailJS 또는 Firebase Functions |
| 메타데이터 포함 | ⏳ 대기 | userId, tier, 브라우저, 기기 정보 |
| **3. 인센티브 시스템** | | |
| 피드백 제출 시 +1 리딩 | ⏳ 대기 | 무료 리딩 1회 즉시 부여 |
| 주 1회 제한 | ⏳ 대기 | 스팸 방지 (추후 월 1회로 조정 가능) |
| 마지막 피드백 시간 저장 | ⏳ 대기 | Firestore users/{uid}/lastFeedbackAt |
| 보너스 획득 토스트 | ⏳ 대기 | "소중한 의견 감사해요! 🎁 무료 리딩 +1" |
| **4. 마이페이지 연동** | | |
| 피드백 보내기 버튼 | ⏳ 대기 | 프로필 섹션에 배치 |
| 쿨다운 상태 표시 | ⏳ 대기 | "다음 피드백까지 N일" |
| 피드백 히스토리 (선택) | ⏳ 대기 | 내가 보낸 피드백 목록 |

### Phase 12: 타로 카드 선택 UX 전면 개편 🎮 대기
> 게임처럼 몰입감 있고 고급스러운 카드 선택 경험 (VN Intro 참고)

| 작업 | 상태 | 비고 |
|------|------|------|
| **1. 레이아웃 개편** | | |
| "3장을 선택하면..." 배너 제거 | ⏳ 대기 | 불필요한 안내 삭제 |
| 카드 스프레드 상단 배치 | ⏳ 대기 | 메인 인터랙티브 요소를 화면 중앙/상단으로 |
| 풀스크린 몰입형 디자인 | ⏳ 대기 | VN Intro 스타일 배경 + 분위기 |
| **2. 카드 선택 UX 개선** | | |
| 클릭 반응성 개선 | ⏳ 대기 | 싱글클릭으로 즉시 선택 |
| 호버/탭 피드백 강화 | ⏳ 대기 | 카드 살짝 뜨기 + 글로우 효과 |
| 선택 애니메이션 | ⏳ 대기 | 카드 뒤집히며 슬롯으로 이동 |
| 터치/드래그 지원 | ⏳ 대기 | 모바일 스와이프 선택 |
| **3. 비주얼 업그레이드** | | |
| 배경 분위기 통일 | ⏳ 대기 | 어두운 신비로운 그라데이션 |
| 카드 디자인 개선 | ⏳ 대기 | 더 선명하고 고급스러운 카드 뒷면 |
| 파티클/빛 이펙트 | ⏳ 대기 | 가벼운 반짝임 (무겁지 않게) |
| 선택 슬롯 UI 개선 | ⏳ 대기 | 과거/현재/미래 슬롯 더 직관적으로 |
| **4. 사운드 (선택)** | | |
| 카드 선택 효과음 | ⏳ 대기 | 부드러운 카드 뒤집는 소리 |
| 배경 앰비언트 | ⏳ 대기 | 신비로운 분위기 (음소거 가능) |

### Phase 13: 네비게이션 및 FAB 개선 ⏳ 대기
> 직관적인 CTA와 깔끔한 레이아웃

| 작업 | 상태 | 비고 |
|------|------|------|
| **1. 상단 탭 CTA 개선** | | |
| 타로 버튼 문구 | ⏳ 대기 | "+ 운명의 카드" → "타로 보기" |
| 꿈 버튼 문구 | ⏳ 대기 | → "꿈 해몽하기" |
| 사주 버튼 문구 | ⏳ 대기 | → "사주 보기" |
| 탭 디자인 강화 | ⏳ 대기 | 더 눈에 띄는 CTA 스타일 |
| **2. FAB (플로팅 버튼) 개선** | | |
| 위치 조정 | ⏳ 대기 | 피드와 겹치지 않는 위치로 |
| 중복성 검토 | ⏳ 대기 | 상단 탭과의 역할 정리 |
| 컨텍스트 인식 | ⏳ 대기 | 현재 모드에 맞는 액션 표시 |
| 모바일에서만 표시 | ⏳ 대기 | 데스크탑은 상단 탭 사용 |
| **3. Firebase 안정화** | | |
| Firestore 연결 에러 수정 | ⏳ 대기 | WebChannel 에러 해결 |
| Quota 관리 개선 | ⏳ 대기 | 불필요한 Listen 줄이기 |
| 실시간 리스너 최적화 | ⏳ 대기 | 중복 리스너 제거 |
| **4. 알림 시스템 수정** | | |
| 중복 알림 방지 | ⏳ 대기 | 이미 본 피드 알림 안 띄우기 |
| 알림 조건 정리 | ⏳ 대기 | 실제 새 콘텐츠만 알림 |
| 알림 히스토리 저장 | ⏳ 대기 | 마지막 확인 시간 기록 |

### Phase 14: Firebase 비용 최적화 💰 대기
> 유저 확장 대비 Firestore 읽기/쓰기 효율화

**현재 상황 분석 (1인 테스트 기준):**
| 항목 | 현재 사용 | 무료 한도 | 100명 예상 | 초과율 |
|------|----------|----------|-----------|--------|
| 읽기/일 | 2,800 | 50,000 | ~280,000 | 5.6배 |
| 쓰기/일 | 1,800 | 20,000 | ~180,000 | 9배 |

**예상 월 비용:** 100명 ~$15, 1,000명 ~$150, 10,000명 ~$1,500

| 작업 | 상태 | 비고 | 절감 효과 |
|------|------|------|----------|
| **1. 쓰기 최적화** | | | |
| Presence heartbeat 주기 변경 | ⏳ 대기 | 30초 → 5분 | 쓰기 **90% 감소** |
| 배치 쓰기 (batch write) | ⏳ 대기 | 여러 문서 한번에 저장 | 쓰기 20% 감소 |
| 불필요한 업데이트 제거 | ⏳ 대기 | 변경 없으면 쓰기 스킵 | 쓰기 30% 감소 |
| **2. 읽기 최적화** | | | |
| onSnapshot → getDocs | ⏳ 대기 | 피드를 일반 쿼리로 전환 | 읽기 **70% 감소** |
| 페이지네이션 적용 | ⏳ 대기 | 무한스크롤 대신 페이지 | 읽기 50% 감소 |
| 쿼리 결과 캐싱 | ⏳ 대기 | React Query/SWR 도입 | 읽기 30% 감소 |
| 필드 선택적 조회 | ⏳ 대기 | 필요한 필드만 select | 대역폭 감소 |
| **3. 실시간 기능 축소** | | | |
| 실시간 피드 → 새로고침 버튼 | ⏳ 대기 | "새 글 N개" 버튼으로 대체 | 읽기 80% 감소 |
| Presence 간소화 | ⏳ 대기 | 접속자 수만 표시 (개별 X) | 읽기/쓰기 감소 |
| 댓글 실시간 → 폴링 | ⏳ 대기 | 30초 간격 폴링으로 변경 | 읽기 50% 감소 |
| **4. 인프라 대안 검토** | | | |
| Firestore → Supabase 검토 | ⏳ 대기 | 무료 할당량 더 많음 | 비용 절감 |
| Redis 캐시 레이어 | ⏳ 대기 | 자주 읽는 데이터 캐싱 | 읽기 감소 |
| CDN 정적 콘텐츠 | ⏳ 대기 | 이미지/폰트 CDN 활용 | 대역폭 감소 |

### Phase 15: SEO 콘텐츠 전략 📈 대기
> "타로 보기", "꿈 해몽", "사주 보기" 등 핵심 키워드 검색 1페이지 노출 목표

**타겟 키워드 분석:**
| 키워드 | 월간 검색량 (추정) | 경쟁도 | 전략 |
|--------|------------------|--------|------|
| 무료 타로 | 50,000+ | 높음 | 장기 목표 |
| 오늘의 타로 | 30,000+ | 중간 | 중기 목표 |
| 꿈 해몽 | 40,000+ | 높음 | 장기 목표 |
| 뱀꿈 해몽 | 10,000+ | 낮음 | **단기 가능** |
| 무료 사주 | 30,000+ | 높음 | 장기 목표 |
| 오늘의 운세 | 20,000+ | 중간 | 중기 목표 |

| 작업 | 상태 | 비고 |
|------|------|------|
| **1. 플랫폼 선택** | | |
| 블로그 통합 vs 워드프레스 | ⏳ 검토 | 아래 비교표 참고 |
| 서브도메인 전략 | ⏳ 대기 | blog.jeom.ai vs jeom.ai/blog |
| **2. 롱테일 키워드 콘텐츠** | | |
| 꿈 해몽 사전 페이지 | ⏳ 대기 | /dreams/dictionary/뱀, /용, /물 등 |
| 타로 카드 의미 페이지 | ⏳ 대기 | /tarot/cards/fool, /magician 등 |
| 사주 용어 설명 페이지 | ⏳ 대기 | /saju/terms/갑자, /을축 등 |
| **3. 정보성 콘텐츠** | | |
| "뱀꿈 해몽 총정리" 가이드 | ⏳ 대기 | 2000자+ 심층 콘텐츠 |
| "타로 카드 보는 법" 가이드 | ⏳ 대기 | 초보자 가이드 |
| "사주팔자란?" 입문 가이드 | ⏳ 대기 | 기초 설명 |
| **4. 사용자 생성 콘텐츠 (UGC)** | | |
| 공개 리딩 SEO 최적화 | ⏳ 대기 | 구조화 데이터, 메타태그 |
| 인기 태그 랜딩 페이지 | ⏳ 대기 | /tag/연애운, /tag/직장운 |
| 실시간 트렌딩 키워드 | ⏳ 대기 | 오늘 많이 검색된 꿈/타로 |
| **5. 기술적 SEO** | | |
| 사이트맵 자동 생성 | ⏳ 대기 | 신규 콘텐츠 즉시 반영 |
| 내부 링크 구조 최적화 | ⏳ 대기 | 관련 콘텐츠 상호 연결 |
| Core Web Vitals 최적화 | ⏳ 대기 | LCP, FID, CLS 개선 |
| Google Search Console 연동 | ⏳ 대기 | 인덱싱 모니터링 |

**블로그 플랫폼 비교:**
```
┌─────────────────────────────────────────────────────────────┐
│  옵션 1: 앱 내 블로그 통합 (jeom.ai/blog)                     │
├─────────────────────────────────────────────────────────────┤
│  장점:                                                       │
│  • 도메인 권한 통합 (SEO 시너지)                              │
│  • 사용자 경험 일관성                                         │
│  • 리딩 → 블로그 자연스러운 연결                              │
│  • 관리 포인트 하나                                           │
│                                                             │
│  단점:                                                       │
│  • 개발 시간 필요 (CMS 구축)                                  │
│  • 초기 구축 복잡                                             │
├─────────────────────────────────────────────────────────────┤
│  추천도: ⭐⭐⭐⭐ (장기적으로 Best)                            │
└─────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│  옵션 2: 워드프레스 (blog.jeom.ai)                            │
├─────────────────────────────────────────────────────────────┤
│  장점:                                                       │
│  • 즉시 시작 가능                                             │
│  • SEO 플러그인 풍부 (Yoast, RankMath)                       │
│  • 콘텐츠 관리 쉬움                                           │
│  • 다양한 테마                                                │
│                                                             │
│  단점:                                                       │
│  • 서브도메인 = 별도 도메인 취급 (SEO 분산)                   │
│  • 호스팅 비용 추가 ($5-20/월)                               │
│  • 디자인 통일 어려움                                         │
│  • 보안 관리 필요                                             │
├─────────────────────────────────────────────────────────────┤
│  추천도: ⭐⭐⭐ (빠른 시작용)                                  │
└─────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│  옵션 3: 정적 페이지 (jeom.ai/guide/*)                        │
├─────────────────────────────────────────────────────────────┤
│  장점:                                                       │
│  • 개발 간단 (React 컴포넌트)                                 │
│  • 빠른 로딩 속도                                             │
│  • 도메인 권한 유지                                           │
│                                                             │
│  단점:                                                       │
│  • 콘텐츠 수정 = 코드 배포                                    │
│  • 비개발자 수정 불가                                         │
├─────────────────────────────────────────────────────────────┤
│  추천도: ⭐⭐⭐⭐ (핵심 가이드 10-20개용)                      │
└─────────────────────────────────────────────────────────────┘

💡 권장 전략 (하이브리드):
───────────────────────────
1단계: 정적 페이지로 핵심 가이드 10개 먼저 작성
       /guide/dream-snake (뱀꿈 해몽 완벽 가이드)
       /guide/tarot-beginner (타로 입문 가이드)
       → 빠르게 검색 노출 시작

2단계: UGC 콘텐츠 SEO 강화
       공개된 꿈/타로 리딩이 자동으로 SEO 페이지 역할
       → 롱테일 키워드 자연 유입

3단계: (선택) 트래픽 증가 시 CMS 구축 또는 Notion API 연동
       콘텐츠 양이 많아지면 관리 시스템 도입
```

**1페이지 진입을 위한 콘텐츠 공식:**
```
┌─────────────────────────────────────────────────────────────┐
│  검색 1페이지 콘텐츠 체크리스트                                │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ☐ 제목에 핵심 키워드 포함                                   │
│    예: "뱀꿈 해몽 - 뱀 나오는 꿈의 의미와 해석 총정리"        │
│                                                             │
│  ☐ 2,000자 이상 심층 콘텐츠                                  │
│    • 서론 (검색 의도 충족 약속)                               │
│    • 본론 (상세 설명, 예시, 이미지)                           │
│    • 결론 (요약 + CTA)                                       │
│                                                             │
│  ☐ 구조화된 포맷                                             │
│    • H1 > H2 > H3 계층 구조                                  │
│    • 목차 (Table of Contents)                                │
│    • 불릿 포인트, 표, 이미지                                  │
│                                                             │
│  ☐ 내부/외부 링크                                            │
│    • 관련 콘텐츠 3-5개 링크                                   │
│    • 권위 있는 외부 소스 인용                                 │
│                                                             │
│  ☐ Schema 마크업                                             │
│    • FAQ Schema (자주 묻는 질문)                              │
│    • HowTo Schema (방법 가이드)                               │
│    • Article Schema (블로그/가이드)                           │
│                                                             │
│  ☐ 사용자 참여 유도                                          │
│    • "지금 바로 AI 꿈 해몽 받기" CTA                          │
│    • 댓글/공유 기능                                           │
│    • 관련 리딩 추천                                           │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## AI Tier System 상세 설계

### 현재 구조 분석
```
현재 (단일 티어):
├── 텍스트: Claude Sonnet 4.5 (claude-sonnet-4-5)
├── 이미지: Gemini 2.0 Flash (gemini-2.0-flash-exp)
├── 키워드: 텍스트와 함께 생성 (Sonnet 4.5)
└── 모든 사용자 동일 품질
```

### 새로운 구조 (Tiered System) - v4 (3티어 시스템)
```
┌─────────────────────────────────────────────────────────────┐
│              AI MODEL TIER SYSTEM (v4 - 3티어)               │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  핵심 원칙: 기능 해금 → AI 품질 업그레이드 분리!            │
│  무료 → 프리미엄: 기능 해금 (같은 AI)                       │
│  프리미엄 → 울트라: AI 품질 업그레이드 (소름돋는 통찰)      │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  🆓 FREE TIER (무료)                                 │   │
│  ├─────────────────────────────────────────────────────┤   │
│  │  텍스트 AI    : Claude Sonnet 4.5 (정확한 해석)      │   │
│  │  이미지 AI    : Gemini 2.0 Flash (HD)               │   │
│  │                                                      │   │
│  │  제한:                                               │   │
│  │  • 꿈/타로/사주: 주 3회                              │   │
│  │  • Hidden Insight: 블러 처리                         │   │
│  │  • 심층 분석: 잠김                                   │   │
│  │  • 히스토리: 최근 3개                                │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  💎 PREMIUM TIER (프리미엄) - ₩6,900/월              │   │
│  ├─────────────────────────────────────────────────────┤   │
│  │  텍스트 AI    : Claude Sonnet 4.5 (깊이 있는 해석)   │   │
│  │  이미지 AI    : Gemini 3 Pro Preview (HD)           │   │
│  │                                                      │   │
│  │  해금:                                               │   │
│  │  • 무제한 사용                                       │   │
│  │  • Hidden Insight 전체 공개                          │   │
│  │  • 심층 분석 열림                                    │   │
│  │  • 히스토리 무제한                                   │   │
│  │  • 맞춤 질문 자유 입력                               │   │
│  │  • HD 이미지 (Gemini 3 Pro)                         │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  ✨ ULTRA TIER (울트라) - ₩9,900/월                  │   │
│  ├─────────────────────────────────────────────────────┤   │
│  │  텍스트 AI    : Claude Opus 4.5 (소름돋는 통찰!)     │   │
│  │  이미지 AI    : Gemini 3 Pro Preview (HD)           │   │
│  │                                                      │   │
│  │  프리미엄 모든 기능 +                                │   │
│  │  • 소름돋는 깊이의 해석                              │   │
│  │  • 당신만 몰랐던 통찰                                │   │
│  │  • 더 섬세한 맞춤 분석                               │   │
│  │  • 특별한 인사이트                                   │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 핵심 설계 원칙 (v4 - 3티어 시스템)

```
┌─────────────────────────────────────────────────────────────┐
│  핵심: "기능 해금"과 "AI 품질 업그레이드" 분리!              │
│                                                             │
│  무료 → 프리미엄: 기능 해금 (같은 AI)                       │
│  프리미엄 → 울트라: AI 품질 업그레이드 (소름돋는 통찰)      │
└─────────────────────────────────────────────────────────────┘

1. 텍스트 AI 티어 구조
   ─────────────────────────────────────────────────
   Free/Premium: Claude Sonnet 4.5 (정확한/깊이 있는 해석)
   Ultra: Claude Opus 4.5 (소름돋는 통찰!)

   → 무료/프리미엄: Sonnet으로 "와 좋다" 경험
   → 울트라: Opus로 "이건 차원이 다르다" 압도
   → 기능 해금 후 AI 업그레이드 = 자연스러운 업셀링

2. 이미지 AI 티어 구조
   ─────────────────────────
   Free: Gemini 2.0 Flash (HD)
   Premium/Ultra: Gemini 3 Pro Preview (HD)

   ※ 이미지는 모두 HD (Ultra HD는 오버킬)
   ※ IMAGE_CONFIG: 리딩 16:9, 내보내기 1:1

3. 프리미엄 차별화 (기능 해금)
   ─────────────────────────
   • Hidden Insight 전체 공개 (블러 해제)
   • 심층 분석 해금
   • 무제한 사용
   • 히스토리 무제한
   • 맞춤 질문 자유 입력
   → "숨겨진 메시지 보고 싶다" 니즈 해결

4. 울트라 차별화 (AI 품질)
   ─────────────────────────
   • 프리미엄 모든 기능 +
   • 소름돋는 깊이의 해석 (Opus 4.5)
   • 당신만 몰랐던 통찰
   • 더 섬세한 맞춤 분석
   → "더 소름돋는 해석 원한다" 니즈 해결

5. 감성적 문구 (기술 용어 숨김)
   ─────────────────────────
   ❌ "Opus 4.5로 업그레이드!"
   ✅ "소름돋는 통찰이 기다려요"

   ❌ "Sonnet 4.5 (고품질)"
   ✅ "정확한 해석" / "깊이 있는 해석"

6. 가격 전략
   ─────────────────────────
   프리미엄: ₩6,900/월 (92% 마진!)
   울트라: ₩9,900/월 (65% 마진)
   1회권: ₩1,900 / ₩2,900

7. 광고 전략
   ─────────────────────────
   초반: 광고 없음 (프리미엄 느낌 유지)
   나중에 넣는다면: 꿈 라이브러리 섹션에 네이티브 광고
   절대 금지: 리딩 로딩 중 인터스티셜 (분위기 파괴)
```

### 기술 구현 (v4 - 3티어 시스템)

```javascript
// src/utils/aiConfig.js

export const AI_MODELS = {
  // 텍스트 분석 모델 (3티어!)
  text: {
    free: 'claude-sonnet-4-5',       // 정확한 해석
    premium: 'claude-sonnet-4-5',    // 깊이 있는 해석 (기능 해금)
    ultra: 'claude-opus-4-5'         // 소름돋는 통찰!
  },

  // 키워드 생성 (Sonnet 고정 - SEO 품질 보장)
  keywords: 'claude-sonnet-4-5',

  // 이미지 생성 (티어별 차등)
  image: {
    free: 'gemini-2.0-flash-exp',       // HD (무료)
    premium: 'gemini-3-pro-image-preview', // HD (프리미엄)
    ultra: 'gemini-3-pro-image-preview'    // HD (울트라)
  }
};

// Gemini 3 Pro Image 설정
export const IMAGE_CONFIG = {
  reading: { aspectRatio: '16:9', imageSize: 'HD' },  // 리딩 결과
  export: { aspectRatio: '1:1', imageSize: 'HD' }    // 내보내기용
};

export const getModelConfig = (tier = 'free') => {
  const isPremium = tier === 'premium' || tier === 'ultra';
  const isUltra = tier === 'ultra';

  return {
    textModel: AI_MODELS.text[tier] || AI_MODELS.text.free,
    keywordModel: AI_MODELS.keywords,
    imageModel: AI_MODELS.image[tier] || AI_MODELS.image.free,
    promptStyle: 'mrBeastDopamine',

    // 분석 깊이
    analysisDepth: isUltra ? 'ultra' : (isPremium ? 'deep' : 'basic'),
    maxTokens: isUltra ? 8000 : (isPremium ? 6000 : 4000),

    // 콘텐츠 접근 권한
    hasHiddenInsight: isPremium,      // 프리미엄+ 해금
    hasDetailedAnalysis: isPremium,   // 프리미엄+ 해금
    hasUltraInsight: isUltra,         // 울트라만

    tier, isPremium, isUltra
  };
};
```

### 프롬프트 전략 (수정됨)

```javascript
// 모든 티어: MrBeast 도파민 프롬프트 (동일)
// → 무료도 좋은 경험 제공
// → 차별화는 콘텐츠 접근/사용량으로

const getMrBeastPrompt = (dreamContent, userName) => `
${dreamContent}에 대한 꿈 해석을 JSON으로 제공하세요.
${userName}님을 위한 개인화된 분석을 작성하세요.

구조:
1. Hook: 핵심 의미 먼저 + 반전 ("나쁜 꿈 아니에요. 오히려...")
2. Foreshadow: 못 보면 잠 못 잠 ("숨겨진 메시지가 있어요...")
3. Keywords: 각 상징 5-7문장 깊이 분석
4. Bonus: 예상치 못한 추가 인사이트 ("이건 안 물어봤는데...")
5. Twist: 반전 메시지 (문장 끝 반전 필수)
6. Hidden Insight: 4-6문장 봉인 해제 메시지 ← 무료는 블러!

// 무료 티어: Hidden Insight, 심층 분석 블러/잠금으로 차별화
// 프리미엄 티어: 모든 콘텐츠 해금

{
  "title": "흥미로운 제목",
  "summary": "호기심 유발 요약",
  "interpretations": [
    {"title": "Hook 해석", "content": "4-5문장, 흥미롭게"},
    {"title": "심층 해석", "content": "4-5문장"},
    {"title": "반전 해석", "content": "4-5문장, Twist"},
    {"title": "보너스 해석", "content": "4-5문장"},
    {"title": "개인 맞춤", "content": "${userName}님에게 특별히..."}
  ],
  "hiddenInsight": "5-7문장의 가장 깊은 숨겨진 의미",
  "personalAdvice": "${userName}님을 위한 조언",
  "luckyColor": "행운의 색",
  "luckyNumber": 7,
  "luckyDay": "행운의 요일"
}
`;
```

### 사용자 비교 UI (v3 - Opus 업그레이드)

```
┌─────────────────────────────────────────────────────────────┐
│               🆓 무료 vs ✨ 프리미엄 비교                    │
├─────────────────────┬───────────────────────────────────────┤
│                     │                                       │
│  🆓 무료 리딩        │  ✨ 프리미엄 리딩                      │
│  ────────────       │  ──────────────                       │
│                     │                                       │
│  🧠 고품질 AI        │  🧠 최상위 AI ⭐                       │
│    (Sonnet 4.5)     │    (Opus 4.5)                         │
│                     │                                       │
│  📚 심층 해석 5가지   │  📚 더 깊은 해석 5가지                 │
│                     │     + Opus의 섬세한 통찰               │
│                     │                                       │
│  🔒 Hidden Insight   │  ✅ Hidden Insight 해금               │
│     (블러+힌트)       │                                       │
│                     │                                       │
│  🔒 심층 분석 잠금    │  ✅ 심층 분석 해금                     │
│                     │                                       │
│  🖼️ HD 이미지       │  🖼️ Ultra HD 이미지                   │
│    (Gemini Flash)   │    (Gemini 3 Pro)                     │
│                     │                                       │
│  📚 히스토리 3개     │  📚 히스토리 무제한                    │
│                     │                                       │
│  ❓ 템플릿 질문만    │  ✅ 맞춤 질문 자유 입력                │
│                     │                                       │
│  ❌ 패턴 분석        │  ✅ 꿈/타로 패턴 분석                  │
│                     │                                       │
│  ❌ 사주 궁합        │  ✅ 궁합/연간운세                      │
│                     │                                       │
│  주 3회 제한         │  무제한 사용                          │
│                     │                                       │
│  ─────────────      │  ─────────────                        │
│  "와 이거 좋다"       │  "이건 차원이 다르다"                  │
│  Sonnet으로 시작!    │  Opus로 압도!                         │
│                     │                                       │
└─────────────────────┴───────────────────────────────────────┘
```

### 비용 분석 (v4 - 3티어 시스템)

```
API 호출당 예상 비용 (2025년 기준):

Free Tier (1회 리딩):
├── Sonnet 4.5 텍스트+키워드: ~$0.008
├── Gemini 2.0 Flash 이미지: ~$0.002
└── 총: ~$0.010 (~14원)

Premium Tier (1회 리딩):
├── Sonnet 4.5 텍스트: ~$0.008
├── Sonnet 4.5 키워드: ~$0.003
├── Gemini 3 Pro 이미지: ~$0.005
└── 총: ~$0.016 (~22원)

Ultra Tier (1회 리딩):
├── Opus 4.5 텍스트: ~$0.075 (Sonnet 대비 약 9배)
├── Sonnet 4.5 키워드: ~$0.003
├── Gemini 3 Pro 이미지: ~$0.005
└── 총: ~$0.083 (~115원)

수익성 분석 (3티어):
─────────────────────
• Free: 하루 1회 × 30일 × 14원 = 420원/월 (비용만)

• Premium (₩6,900/월):
  30회/월 × 22원 = 660원 비용 → 90%+ 마진! 💰

• Ultra (₩9,900/월):
  30회/월 × 115원 = 3,450원 비용 → 65% 마진

※ 3티어 전략의 장점:
   - 프리미엄: 고마진으로 안정적 수익
   - 울트라: 파워유저 수익화
   - 프리미엄이 주력, 울트라는 업셀링
```

---

## 핵심 철학: Pieter Levels식 pSEO

### 원칙
1. **모든 페이지는 유용해야 한다** - 빈 페이지, 의미없는 페이지 금지
2. **검색 의도(Search Intent)를 만족시켜야 한다** - 사용자가 원하는 정보 제공
3. **Win-Win 구조** - 사용자는 가치를 얻고, 플랫폼은 트래픽을 얻는다
4. **데이터 → 페이지 자동화** - 모든 유의미한 데이터가 검색 가능한 페이지가 된다

### 우리 서비스에 적용
```
RemoteOK 방식              →  Dream Storybook 적용
─────────────────────────────────────────────────────
회사별 채용 페이지          →  태그별 콘텐츠 페이지 (/tag/뱀)
구직자 프로필 페이지        →  사용자 공개 프로필 (/user/{id})
직업 카테고리 페이지        →  콘텐츠 타입 페이지 (/dreams, /tarots, /saju)
도시별 페이지 (NomadList)   →  카테고리별 페이지 (/dreams/category/animal)
```

---

## 1. 통합 태그/카테고리 시스템 (Master Architecture)

### 문제점: 현재 분산된 시스템
```
현재 (복잡하고 비효율적):
├── 꿈: keywords[], dreamType, DREAM_CATEGORIES
├── 타로: keywords[], topic, TAROT_CATEGORIES
├── 사주: keywords[], SAJU_CATEGORIES
└── 각각 따로 놀고, 연결 안 됨
```

### 해결: 통합 태그 시스템
```
새로운 구조 (심플하고 유기적):
├── 모든 콘텐츠 → tags[] 배열로 통일
├── 태그 = 카테고리 = 상징 = 키워드 (모두 하나의 시스템)
└── 타입(dream/tarot/saju)으로만 구분
```

### Firebase 구조

```javascript
// 콘텐츠 저장 구조 (통일)
dreams/{id} | tarots/{id} | sajus/{id}
{
  // 기본 정보
  type: "dream" | "tarot" | "saju",
  title: "뱀에게 쫓기는 꿈",

  // 통합 태그 시스템 (핵심!)
  tags: ["뱀", "공포", "도망", "변화", "동물"],
  primaryTag: "뱀",  // 대표 태그 (SEO용)

  // 공개 설정 (통일)
  visibility: "private" | "unlisted" | "public",
  isAnonymous: false,  // 공개 시 익명 여부

  // 메타
  userId: "xxx",
  userName: "꿈꾸는자" | "익명",
  createdAt: Timestamp,

  // ... 기존 콘텐츠 데이터
}

// 태그 집계 컬렉션
tags/{tagName}
{
  name: "뱀",
  slug: "snake",  // URL용

  // 타입별 카운트
  totalCount: 234,
  dreamCount: 156,
  tarotCount: 67,
  sajuCount: 11,

  // SEO 메타데이터
  seoTitle: "뱀 꿈해몽 - 뱀 꿈 의미와 해석",
  seoDescription: "뱀이 나오는 꿈의 의미를 알아보세요...",

  // 관련 태그 (자동 집계)
  relatedTags: ["동물", "공포", "변화", "재물"],

  // 통계
  weeklyCount: 23,  // 트렌딩 계산용
  updatedAt: Timestamp
}
```

### 태그 자동 분류 체계

```javascript
// 태그 카테고리 (내부 관리용, 사용자에겐 보이지 않음)
const TAG_HIERARCHY = {
  // 꿈 중심 태그
  animals: ["뱀", "호랑이", "개", "고양이", "용", "물고기", "새"],
  nature: ["물", "불", "바다", "산", "하늘", "비", "눈"],
  people: ["가족", "엄마", "아빠", "친구", "연인", "돌아가신분"],
  actions: ["날다", "떨어지다", "쫓기다", "죽다", "울다"],
  places: ["집", "학교", "회사", "병원", "엘리베이터"],
  emotions: ["무서운", "행복한", "슬픈", "불안한"],

  // 타로/사주 중심 태그
  topics: ["연애", "직장", "재물", "건강", "학업", "인간관계"],
  timing: ["오늘", "이번주", "이번달", "올해"],

  // 공통 상징
  symbols: ["변화", "시작", "끝", "기회", "위험", "성공", "실패"]
};
```

---

## 2. URL 구조 및 pSEO 페이지

### 라우팅 맵

```
메인 페이지
/                                 → 앱 메인

태그 시스템 (핵심 pSEO)
/tag/{tagName}                    → 통합 태그 페이지
/tag/{tagName}?type=dream         → 꿈만 필터
/tag/{tagName}?type=tarot         → 타로만 필터
/tag/{tagName}?type=saju          → 사주만 필터
/tags                             → 전체 태그 탐색 (인기순)
/tags/trending                    → 트렌딩 태그

콘텐츠 타입별 목록 (pSEO)
/dreams                           → 꿈해몽 전체
/dreams/category/{category}       → 동물꿈, 자연꿈 등
/tarots                           → 타로 전체
/tarots/category/{category}       → 연애타로, 직장타로 등
/saju                             → 사주 전체
/saju/category/{category}         → 카테고리별

개별 콘텐츠 (pSEO)
/dream/{id}                       → 개별 꿈 페이지
/tarot/{id}                       → 개별 타로 페이지
/saju/{id}                        → 개별 사주 페이지

사용자 프로필 (pSEO)
/user/{userId}                    → 공개 프로필 (공개 콘텐츠만)
```

### 페이지별 SEO 전략

```
/tag/뱀 페이지 예시:
─────────────────────
Title: 뱀 꿈해몽 & 타로 - 뱀의 의미와 해석 | 꿈 스토리북
Description: 뱀이 나오는 꿈의 의미, 뱀 관련 타로 리딩을 확인하세요.
            156개의 뱀 꿈 해석과 67개의 타로 리딩이 있습니다.
H1: #뱀 - 꿈과 타로에서의 의미
Keywords: 뱀꿈, 뱀꿈해몽, 뱀나오는꿈, 뱀타로, 뱀의미

Structured Data (JSON-LD):
{
  "@type": "CollectionPage",
  "name": "뱀 관련 꿈해몽 & 타로",
  "description": "...",
  "numberOfItems": 234
}
```

---

## 3. 공개 설정 시스템 (통합)

### 3단계 공개 설정

```
┌─────────────────────────────────────────────────────────────┐
│  저장 시 공개 설정 (모든 콘텐츠 동일)                          │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  🔒 나만 보기 (기본값)                                │   │
│  │                                                      │   │
│  │  • 내 마이페이지에서만 보임                           │   │
│  │  • 검색/태그 페이지에 노출 안됨                       │   │
│  │  • pSEO 대상 아님                                    │   │
│  │  • 링크 공유 불가                                    │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  🔗 링크 공유 가능 (Unlisted)                         │   │
│  │                                                      │   │
│  │  • 링크 아는 사람만 접근 가능                         │   │
│  │  • 검색/태그 페이지에 노출 안됨                       │   │
│  │  • pSEO 대상 아님 (noindex)                          │   │
│  │  • 카카오톡 등 공유 가능                              │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  🌐 커뮤니티에 공개                                   │   │
│  │                                                      │   │
│  │  • 피드에 노출                                       │   │
│  │  • 태그 페이지에 노출                                 │   │
│  │  • 검색엔진 크롤링 대상 (pSEO)                        │   │
│  │  • ☑️ 익명으로 공개 (선택)                            │   │
│  │       → 작성자: "익명의 꿈꾸는 자"                    │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 공개 설정 UI 컴포넌트

```jsx
// 저장 모달에 통합
<VisibilitySelector
  value={visibility}
  onChange={setVisibility}
  options={[
    {
      value: 'private',
      icon: '🔒',
      label: '나만 보기',
      description: '내 마이페이지에서만 확인'
    },
    {
      value: 'unlisted',
      icon: '🔗',
      label: '링크로 공유',
      description: '링크 아는 사람만 볼 수 있음'
    },
    {
      value: 'public',
      icon: '🌐',
      label: '커뮤니티에 공개',
      description: '모든 사람이 볼 수 있음',
      extra: (
        <label>
          <input type="checkbox" /> 익명으로 공개
        </label>
      )
    }
  ]}
/>
```

---

## 4. 결제 시스템 전략

### 가격 구조 (v4 - 3티어 시스템)

```
┌─────────────────────────────────────────────────────────────┐
│  수익화 모델 (v4 - 3티어)                                    │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  🆓 무료 (Free)                                              │
│  ──────────                                                 │
│  • AI: Claude Sonnet 4.5 (정확한 해석)                      │
│  • 꿈/타로/사주: 각 주 3회                                  │
│  • HD 이미지 (Gemini Flash)                                 │
│  • Hidden Insight: 블러 처리                                │
│  • 심층 분석: 잠김                                          │
│  • 히스토리: 최근 3개                                       │
│                                                             │
│  ─────────────────────────────────────────────────────────  │
│                                                             │
│  💎 프리미엄 (Premium)                                       │
│  ─────────────────                                          │
│  월간: ₩6,900/월                                            │
│  연간: ₩55,000/년 (월 ₩4,583, 33% 할인)                     │
│  1회권: ₩1,900                                              │
│                                                             │
│  • AI: Claude Sonnet 4.5 (깊이 있는 해석)                   │
│  • 이미지: Gemini Pro (Ultra HD)                            │
│  • 무제한 사용                                               │
│  • Hidden Insight 전체 공개                                  │
│  • 심층 분석 열림                                            │
│  • 히스토리 무제한                                           │
│  • 맞춤 질문 자유 입력                                       │
│                                                             │
│  ─────────────────────────────────────────────────────────  │
│                                                             │
│  ✨ 울트라 (Ultra)                                           │
│  ─────────────────                                          │
│  월간: ₩9,900/월                                            │
│  연간: ₩79,000/년 (월 ₩6,583, 33% 할인)                     │
│  1회권: ₩2,900                                              │
│                                                             │
│  • AI: Claude Opus 4.5 (소름돋는 통찰!)                     │
│  • 프리미엄 모든 기능 +                                      │
│  • 소름돋는 깊이의 해석                                      │
│  • 당신만 몰랐던 통찰                                        │
│  • 더 섬세한 맞춤 분석                                       │
│  • Ultra HD 이미지 (Gemini 3 Pro Preview)                   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 가격 전략 (v4 - 3티어)

```
3티어 전략의 핵심:
───────────────────────
• 프리미엄: 기능 해금에 집중 (AI 동일)
  → "숨겨진 메시지 보고 싶다" 니즈 해결
  → 낮은 가격 (₩6,900)으로 진입 장벽 낮춤

• 울트라: AI 품질 업그레이드
  → "더 소름돋는 해석 원한다" 니즈 해결
  → 프리미엄 대비 +₩3,000 업셀링

마진 분석:
───────────────────────
프리미엄 (₩6,900, Sonnet + Gemini Pro):
• 30회/월: 540원 비용 → 92% 마진! (고수익)

울트라 (₩9,900, Opus + Gemini Pro):
• 30회/월: 3,450원 비용 → 65% 마진

1회권 전략:
───────────────────────
• 프리미엄 1회: ₩1,900 → 4회면 구독이 이득
• 울트라 1회: ₩2,900 → 4회면 구독이 이득
• 라이트 유저도 수익화 가능
```

### 무료 vs 프리미엄 비교 모달 (v3 - Opus 업그레이드)

```
┌─────────────────────────────────────────────────────────────┐
│                 ✨ Opus 4.5로 업그레이드                      │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  "당신의 숨겨진 두려움과 관련된 메시지가 있습니다"            │
│                                                             │
│  ┌─────────────────────┬─────────────────────┐              │
│  │      🆓 무료         │    ✨ 프리미엄       │              │
│  ├─────────────────────┼─────────────────────┤              │
│  │                     │                     │              │
│  │  🧠 Sonnet 4.5      │  🧠 Opus 4.5 ⭐      │              │
│  │  (고품질)           │  (최상위!)           │              │
│  │                     │                     │              │
│  ├─────────────────────┼─────────────────────┤              │
│  │  🔒 Hidden Insight   │  ✅ Hidden Insight   │              │
│  │     (블러+힌트)       │     (완전 해금)      │              │
│  ├─────────────────────┼─────────────────────┤              │
│  │  🔒 심층 분석        │  ✅ 심층 분석        │              │
│  │     (잠금)           │     (해금)          │              │
│  ├─────────────────────┼─────────────────────┤              │
│  │  🖼️ HD 이미지        │  🖼️ Ultra HD        │              │
│  │     (Gemini Flash)   │     (Gemini 3 Pro)  │              │
│  ├─────────────────────┼─────────────────────┤              │
│  │  📚 히스토리 3개      │  📚 히스토리 무제한   │              │
│  ├─────────────────────┼─────────────────────┤              │
│  │  ❓ 템플릿 질문만     │  ✅ 맞춤 질문        │              │
│  ├─────────────────────┼─────────────────────┤              │
│  │  ❌ 패턴 분석        │  ✅ 꿈/타로 패턴     │              │
│  ├─────────────────────┼─────────────────────┤              │
│  │  ❌ 사주 궁합        │  ✅ 궁합/연간운세     │              │
│  ├─────────────────────┼─────────────────────┤              │
│  │  주 3회 제한         │  무제한              │              │
│  └─────────────────────┴─────────────────────┘              │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  🔥 연간 구독 시 33% 할인!                           │   │
│  │     월 ₩9,900 → 월 ₩6,583 (연 ₩79,000)              │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ┌───────────────┐  ┌───────────────┐  ┌───────────────┐   │
│  │ 이번만 ₩2,900 │  │ 월 ₩9,900    │  │ 연 ₩79,000   │   │
│  │   1회권       │  │   구독하기    │  │   Best Deal!  │   │
│  └───────────────┘  └───────────────┘  └───────────────┘   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### No-Brainer 포인트 (v2)

```
사용자 심리 흐름:
─────────────────
1. 무료로 리딩 받음 → "오 이거 진짜 좋다!" (Sonnet 4.5 품질)
2. Hidden Insight 블러 + 힌트 → "당신의 숨겨진 두려움과... 뭔데?!"
3. 블러 클릭 → 프리미엄 모달 팝업
4. 비교표 봄 → "무료도 Sonnet인데... 프리미엄은 뭐가 다르지?"
5. 차이점 확인 → "패턴 분석, 궁합, 무제한... 이건 좋네"
6. 가격 봄 → "월 4,900원이면 커피 한 잔인데..."
7. 결제 → Hidden Insight + 심층 분석 봄 → "와 이건 돈값 한다"
8. 다음에도 씀 → 꿈/타로 패턴 분석 → "이런 게 있었어?"
9. 계속 사용 → "연간이 더 싸네" → 연간 전환

핵심 차별화:
─────────────
• 무료도 "와" 경험 → 프리미엄 업그레이드 동기
• Hidden Insight 힌트 = 전환율 핵심 (티저 문구)
• 주 3회 = 리텐션 최적화 (매일 오게 함)
• 패턴 분석 = 장기 가치 (계속 쓸수록 의미 있음)
```

---

## 5. pSEO 최적화 전략 (Pieter Levels 방식)

### 페이지 생성 원칙

```
✅ 생성해야 하는 페이지 (유용함):
───────────────────────────────
• /tag/뱀 - 뱀 관련 꿈/타로 모음 (검색 의도: "뱀꿈 해몽")
• /dream/{id} - 개별 꿈 상세 (검색 의도: 비슷한 꿈 찾기)
• /dreams/category/animal - 동물 꿈 모음
• /user/{id} - 공개 프로필 (검색 의도: 해몽가 찾기)

❌ 생성하면 안 되는 페이지 (무가치):
────────────────────────────────
• 콘텐츠 없는 태그 페이지 (0개)
• 너무 구체적인 조합 (/tag/뱀?type=saju&year=2024)
• 중복 콘텐츠 페이지
• 자동 생성된 의미없는 페이지
```

### 태그 페이지 최소 기준

```javascript
// 태그 페이지 생성 조건
const shouldCreateTagPage = (tag) => {
  return (
    tag.totalCount >= 3 &&  // 최소 3개 콘텐츠
    tag.name.length >= 2 && // 한 글자 태그 제외
    !BLOCKED_TAGS.includes(tag.name) // 부적절한 태그 제외
  );
};
```

### SEO 자동화 파이프라인

```
콘텐츠 저장 → 태그 추출 → 태그 카운트 업데이트 → 페이지 자동 생성
     ↓              ↓              ↓                   ↓
  Firebase      정규화         tags 컬렉션        sitemap 갱신
```

### Sitemap 전략

```xml
<!-- sitemap-tags.xml (동적 생성) -->
<urlset>
  <!-- 인기 태그만 포함 (count >= 10) -->
  <url>
    <loc>https://dreamstorybook.com/tag/뱀</loc>
    <lastmod>{현재날짜}</lastmod>  <!-- 동적 생성 -->
    <changefreq>daily</changefreq>
    <priority>0.8</priority>
  </url>
  <!-- ... -->
</urlset>

<!-- sitemap-content.xml (동적 생성) -->
<urlset>
  <!-- 공개 콘텐츠만 포함 -->
  <url>
    <loc>https://dreamstorybook.com/dream/abc123</loc>
    <lastmod>{콘텐츠수정일}</lastmod>  <!-- 동적 생성 -->
    <priority>0.6</priority>
  </url>
  <!-- ... -->
</urlset>
```

### 내부 링크 구조

```
모든 페이지에서 상호 연결:
──────────────────────────
개별 콘텐츠 → 관련 태그들 (클릭 가능)
태그 페이지 → 개별 콘텐츠들
태그 페이지 → 관련 태그들
카테고리 페이지 → 해당 태그들
사용자 프로필 → 해당 사용자 콘텐츠

→ 크롤러가 모든 페이지를 쉽게 발견
→ 페이지 간 링크 주스(Link Juice) 분배
```

---

## 6. 구현 우선순위 (Phase별)

### Phase 0: AI Tier System (1-2일)
```
[P0-1] AI 모델 설정 파일 생성 (aiConfig.js)
[P0-2] getModelConfig() 함수 구현
[P0-3] useReading.js에 티어 분기 로직 적용
[P0-4] 프롬프트 분기 (Free: 간결 / Premium: MrBeast)
[P0-5] 키워드 생성 Sonnet 고정 확인
```

### Phase 1: 기반 작업 ✅ 완료
```
[P1-1] 타로 결과창 하단 뒤로가기/다른질문 버튼 제거
[P1-2] 명조 폰트 → 리디바탕 전체 변경
[P1-3] fortunes → saju 네이밍 전체 변경 (라우팅, 컬렉션명)
```

### Phase 2: 통합 공개 설정 ✅ 완료
```
[P2-1] visibility 필드 통일 (dream/tarot/saju 모두)
[P2-2] 저장 시 공개 설정 UI 컴포넌트 생성
[P2-3] 마이페이지 공개 설정 통합
[P2-4] unlisted 모드 구현 (링크 공유용)
```

### Phase 3: 태그 시스템 (3-5일)
```
[P3-1] 저장 시 keywords → tags 정규화 로직
[P3-2] tags 컬렉션 생성 및 카운트 관리
[P3-3] 키워드 클릭 → /tag/{tagName} 라우팅
[P3-4] TagPage.jsx 생성 (통합 태그 페이지)
[P3-5] 타입별 필터 탭 구현
[P3-6] 관련 태그 표시
```

### Phase 4: pSEO 강화 (2-3일)
```
[P4-1] TagPage SEO 메타데이터 자동 생성
[P4-2] /tags 전체 태그 탐색 페이지
[P4-3] 트렌딩 태그 로직
[P4-4] sitemap 동적 생성 (태그 + 콘텐츠)
[P4-5] robots.txt 최적화
```

### Phase 5: 결제 시스템 (5-7일)
```
[P5-1] 무료/프리미엄 기능 분리 정의
[P5-2] 무료 횟수 제한 로직 구현
[P5-3] Hidden Insight 블러 처리
[P5-4] 프리미엄 비교 모달 UI
[P5-5] 결제 연동 (토스페이먼츠/Stripe)
[P5-6] 구독 상태 관리 (Firebase)
[P5-7] 1회권 구매 로직
```

### Phase 6: 최적화 (2-3일)
```
[P6-1] 광고 시스템 연동 (무료 사용자)
[P6-2] 분석 길이 분기 (무료: Haiku / 프리미엄: Sonnet)
[P6-3] A/B 테스트 설정
```

---

## 7. 기술 스택 요약 (v4 - 3티어 시스템)

```
Frontend:
├── React + Vite
├── React Router (pSEO 라우팅)
├── react-helmet-async (SEO 메타)
└── CSS Modules

Backend:
├── Firebase Firestore (데이터)
├── Firebase Auth (인증)
├── Firebase Functions (서버리스)
└── AI APIs
    ├── Claude Sonnet 4.5 (Free/Premium 텍스트)
    ├── Claude Opus 4.5 (Ultra 텍스트 - 소름돋는 통찰!)
    ├── Gemini 2.0 Flash (Free 이미지 - HD)
    └── Gemini 3 Pro Preview (Premium/Ultra 이미지 - HD)

이미지 설정:
├── 리딩 결과: 16:9, HD
└── 내보내기: 1:1, HD (추후 구현)

결제:
├── 토스페이먼츠 (국내)
├── Firebase Functions (웹훅 처리)
└── 3티어 가격
    ├── 프리미엄: ₩6,900/월 (₩55,000/년)
    ├── 울트라: ₩9,900/월 (₩79,000/년)
    └── 1회권: ₩1,900 / ₩2,900

SEO:
├── 동적 sitemap 생성
├── JSON-LD Structured Data
├── Open Graph 메타태그
└── robots.txt

그로스 (Phase 8):
├── 알림/리마인더 (Firebase Cloud Messaging)
├── 레퍼럴 프로그램 (동적 링크)
├── 온보딩 플로우 개선
├── 시즌 이벤트 시스템
└── i18n (영어 확장 준비)
```

---

## 8. 성공 지표 (KPIs)

```
pSEO 지표:
├── 인덱싱된 페이지 수
├── 오가닉 트래픽
├── 태그 페이지 클릭률
└── 검색 순위 (주요 키워드)

비즈니스 지표:
├── 무료→프리미엄 전환율
├── 1회권 구매 횟수
├── 월간 반복 수익 (MRR)
├── 연간 구독 비율
└── 이탈률 (Churn Rate)

사용자 지표:
├── DAU/MAU
├── 리딩 완료율
├── 공개 설정 비율
├── 태그 클릭률
└── 공유율
```

---

## 부록 A: 마이그레이션 체크리스트

```
[ ] fortunes 컬렉션 → saju 컬렉션 마이그레이션
[ ] 기존 keywords → tags 변환 스크립트
[ ] isPublic → visibility 마이그레이션
[ ] 기존 라우팅 리다이렉트 설정 (/fortune/* → /saju/*)
[ ] SEO 메타데이터 업데이트
[ ] sitemap 재생성
```

---

## 부록 B: 프롬프트 캐싱 구현 가이드

### 개요

프롬프트 캐싱으로 반복되는 시스템 프롬프트 비용을 최대 90% 절감 가능

```
┌─────────────────────────────────────────────────────────────┐
│  프롬프트 캐싱 비용 절감                                      │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  기존 방식:                                                  │
│  ─────────                                                  │
│  매 요청마다 시스템 프롬프트 전체 과금                        │
│  예: 2000 토큰 시스템 프롬프트 × 100회 = 200,000 토큰 과금    │
│                                                             │
│  캐싱 적용:                                                  │
│  ─────────                                                  │
│  첫 요청: 2000 토큰 (cache_creation) → 25% 할증              │
│  이후 99회: 2000 × 99 = 198,000 토큰 → 90% 할인!            │
│                                                             │
│  결과: 약 80-90% 비용 절감 가능                              │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### Claude 프롬프트 캐싱 (명시적)

```javascript
// anthropic SDK 사용
import Anthropic from '@anthropic-ai/sdk';

const client = new Anthropic();

// 캐싱 적용된 요청
const response = await client.messages.create({
    model: "claude-sonnet-4-5-20250514",
    max_tokens: 4000,
    system: [
        {
            type: "text",
            text: `당신은 꿈 해석 전문가입니다...

            [긴 시스템 프롬프트 - 1024 토큰 이상 필요]

            MrBeast 도파민 스타일로 작성하세요:
            1. Hook: 핵심 의미 먼저
            2. Foreshadow: 숨겨진 메시지
            3. Keywords: 상징 분석
            4. Bonus: 추가 인사이트
            5. Twist: 반전 메시지
            ...
            `,
            cache_control: { type: "ephemeral" }  // ← 핵심!
        }
    ],
    messages: [
        {
            role: "user",
            content: dreamContent
        }
    ]
});

// 캐시 사용량 확인
console.log('캐시 생성 토큰:', response.usage.cache_creation_input_tokens);
console.log('캐시 읽기 토큰:', response.usage.cache_read_input_tokens);
// cache_read_input_tokens가 높을수록 비용 절감!
```

### Claude 캐싱 조건

```
┌─────────────────────────────────────────────────────────────┐
│  Claude 캐싱 요구사항                                        │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  1. 최소 토큰 수:                                            │
│     • claude-sonnet-4-5: 1,024 토큰 이상                    │
│     • claude-opus-4-5: 1,024 토큰 이상                      │
│                                                             │
│  2. 캐시 수명 (TTL):                                         │
│     • ephemeral: 5분                                        │
│     • 5분 내 재사용 시 캐시 히트                              │
│     • 사용할 때마다 TTL 갱신됨                               │
│                                                             │
│  3. cache_control 위치:                                      │
│     • system 메시지에 적용                                   │
│     • 또는 tools 정의에 적용                                 │
│     • 여러 breakpoint 가능                                   │
│                                                             │
│  4. 비용:                                                    │
│     • cache_creation: 기본 가격 × 1.25 (25% 할증)           │
│     • cache_read: 기본 가격 × 0.10 (90% 할인!)              │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### Gemini 프롬프트 캐싱 (암시적)

```javascript
// Gemini 2.5+ 모델은 자동으로 캐싱 적용
// 별도 설정 불필요!

const response = await ai.models.generateContent({
    model: 'gemini-2.5-flash',  // 또는 gemini-3-pro
    contents: [
        {
            role: 'user',
            parts: [{ text: prompt }]
        }
    ],
    systemInstruction: longSystemPrompt  // 자동 캐싱됨
});

// 캐시 사용량 확인
const usage = response.usageMetadata;
console.log('캐시 토큰:', usage.cachedContentTokenCount);
// cachedContentTokenCount > 0 이면 캐시 히트!
```

### Gemini 캐싱 조건

```
┌─────────────────────────────────────────────────────────────┐
│  Gemini Implicit Caching 특징                                │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  1. 자동 적용:                                               │
│     • Gemini 2.5+ 모델에서 자동 활성화                       │
│     • 별도 코드 수정 불필요                                   │
│                                                             │
│  2. 캐시 조건:                                               │
│     • 최소 1,024 토큰 이상의 반복 콘텐츠                      │
│     • 프롬프트 시작 부분이 동일해야 함                        │
│                                                             │
│  3. 비용:                                                    │
│     • 캐시 저장: 무료                                        │
│     • 캐시 히트: 입력 가격의 75% 할인                        │
│                                                             │
│  4. 지원 모델:                                               │
│     • gemini-2.0-flash ✅                                   │
│     • gemini-2.5-flash ✅                                   │
│     • gemini-2.5-pro ✅                                     │
│     • gemini-3-pro-image-preview ✅ (예상)                  │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### Dream Storybook 적용 전략

```
┌─────────────────────────────────────────────────────────────┐
│  우리 서비스에 적용                                          │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  1. Claude (텍스트 분석):                                    │
│     • 시스템 프롬프트를 1,024 토큰 이상으로 구성              │
│     • MrBeast 도파민 프롬프트 + 출력 형식 정의               │
│     • cache_control: { type: "ephemeral" } 적용             │
│                                                             │
│  2. Gemini (이미지 생성):                                    │
│     • 2.0 Flash / 3 Pro 모두 자동 캐싱                       │
│     • 이미지 스타일 프롬프트를 프리픽스로 고정               │
│     • 별도 코드 수정 불필요                                   │
│                                                             │
│  3. 예상 비용 절감:                                          │
│     • 시스템 프롬프트: ~2,000 토큰                           │
│     • 100회 요청 기준:                                       │
│       - 기존: 200,000 토큰 × 기본가                         │
│       - 캐싱: 2,500 토큰 × 1.25 + 197,500 × 0.1            │
│             = 약 85% 절감!                                   │
│                                                             │
│  4. 구현 우선순위:                                           │
│     ① Claude 시스템 프롬프트 캐싱 (명시적)                   │
│     ② 캐시 히트율 모니터링                                   │
│     ③ Gemini 자동 캐싱 확인                                  │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 모니터링 코드 예시

```javascript
// src/utils/cacheMonitor.js

/**
 * Claude API 캐시 사용량 추적
 */
export const trackClaudeCacheUsage = (response) => {
    const { usage } = response;

    const stats = {
        inputTokens: usage.input_tokens,
        outputTokens: usage.output_tokens,
        cacheCreationTokens: usage.cache_creation_input_tokens || 0,
        cacheReadTokens: usage.cache_read_input_tokens || 0
    };

    // 캐시 히트율 계산
    const cacheHitRate = stats.cacheReadTokens /
        (stats.inputTokens + stats.cacheReadTokens) * 100;

    console.log(`캐시 히트율: ${cacheHitRate.toFixed(1)}%`);

    // 비용 절감 추정
    const savingsRate = stats.cacheReadTokens * 0.9 / stats.inputTokens;
    console.log(`예상 비용 절감: ${(savingsRate * 100).toFixed(1)}%`);

    return stats;
};

/**
 * Gemini API 캐시 사용량 추적
 */
export const trackGeminiCacheUsage = (response) => {
    const usage = response.usageMetadata;

    const stats = {
        promptTokens: usage.promptTokenCount,
        candidatesTokens: usage.candidatesTokenCount,
        cachedTokens: usage.cachedContentTokenCount || 0
    };

    // 캐시 히트율 계산
    const cacheHitRate = stats.cachedTokens / stats.promptTokens * 100;
    console.log(`Gemini 캐시 히트율: ${cacheHitRate.toFixed(1)}%`);

    return stats;
};
```

---

## 부록 C: 모바일 최적화 전략 (Phase 10 상세)

> 🎯 **벤치마크: 토스 앱** - 직관적이고 편리한 모바일 UX의 정수
> 대다수 사용자가 모바일로 접속할 것으로 예상되므로 모바일 친화적 UI/UX는 필수

### C.1 현황 분석

#### 현재 문제점

```
┌─────────────────────────────────────────────────────────────┐
│  현재 모바일 접속 시 문제점                                    │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  1. 3단 레이아웃이 그대로 표시됨:                             │
│     • 좌측 피드 (280px) + 중앙 콘텐츠 + 우측 (320px)         │
│     • 모바일에서 가로 스크롤 발생 또는 겹침                   │
│                                                             │
│  2. 오버레이 문제:                                           │
│     • 중앙 콘텐츠가 사이드바 위에 겹쳐서 표시                 │
│     • 터치 불가능한 영역 발생                                 │
│                                                             │
│  3. 터치 최적화 부재:                                         │
│     • 버튼/링크 크기가 44px 미만                              │
│     • hover 상태가 모바일에서 이상하게 동작                   │
│                                                             │
│  4. 비효율적 공간 사용:                                       │
│     • 모바일 화면에서 불필요한 여백                           │
│     • 중요 콘텐츠가 스크롤 없이 보이지 않음                   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

#### CSS 현황 분석

```
CSS 파일 구조 (51개 @media 쿼리, 18개 파일):
─────────────────────────────────────────────

src/styles/
├── base/
│   └── responsive.css (3 breakpoints)
│       • 1200px: 데스크탑
│       • 1024px: 태블릿
│       • 640px: 모바일
│
├── layouts/
│   ├── main-layout.css (3단 레이아웃 정의)
│   │   • 좌측: 280px 고정
│   │   • 중앙: flex-grow
│   │   • 우측: 320px 고정
│   │
│   └── navbar.css (네비게이션)
│
├── components/
│   ├── cards/
│   ├── modals/
│   └── forms/
│
└── pages/
    └── seo-pages.css

문제점:
• 모바일 스타일이 여러 파일에 분산
• 일관된 breakpoint 사용 안 됨
• mobile-first 접근 아님 (desktop-first)
```

### C.2 개선 전략: 토스 스타일 모바일 UX

#### 핵심 원칙

```
┌─────────────────────────────────────────────────────────────┐
│  토스 앱에서 배우는 모바일 UX 원칙                            │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  1. 원핸드 사용성 (One-hand usability)                       │
│     • 주요 액션은 화면 하단에 배치                           │
│     • 엄지손가락 도달 범위 고려                              │
│     • 바텀 네비게이션 필수                                   │
│                                                             │
│  2. 즉각적인 피드백 (Instant feedback)                       │
│     • 모든 터치에 시각적 반응                                │
│     • 로딩 상태 명확히 표시 (Skeleton UI)                    │
│     • 성공/실패 토스트 메시지                                │
│                                                             │
│  3. 단순함 (Simplicity)                                      │
│     • 한 화면에 하나의 핵심 기능                             │
│     • 불필요한 요소 제거                                     │
│     • 직관적인 아이콘과 레이블                               │
│                                                             │
│  4. 부드러운 전환 (Smooth transitions)                       │
│     • 페이지 전환 애니메이션                                 │
│     • 바텀시트 스와이프                                      │
│     • 자연스러운 스크롤                                      │
│                                                             │
│  5. 일관성 (Consistency)                                     │
│     • 동일한 액션은 동일한 위치                              │
│     • 통일된 컴포넌트 스타일                                 │
│     • 예측 가능한 UX 패턴                                    │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### C.3 레이아웃 재구성

#### 데스크탑 vs 모바일 레이아웃

```
데스크탑 (1024px+):
┌─────────────────────────────────────────────────────────────┐
│  NavBar (상단 고정)                                          │
├──────────┬───────────────────────────┬──────────────────────┤
│          │                           │                      │
│  피드     │      메인 콘텐츠           │     우측 패널        │
│  280px   │      (flex)               │     320px           │
│          │                           │                      │
│  • 최신   │                           │  • 프로필           │
│  • 인기   │                           │  • 통계             │
│          │                           │                      │
└──────────┴───────────────────────────┴──────────────────────┘

모바일 (768px 미만):
┌─────────────────────────────┐
│  NavBar (간소화)             │
├─────────────────────────────┤
│                             │
│      메인 콘텐츠 (100%)       │
│                             │
│      • 풀스크린 카드 뷰       │
│      • 스와이프 가능          │
│                             │
│                             │
├─────────────────────────────┤
│  바텀 네비게이션              │
│  🏠  📚  ✨  👤            │
│  홈  피드  리딩  마이          │
└─────────────────────────────┘

피드 접근: 바텀시트로 슬라이드업
설정/프로필: 바텀 네비 > 마이페이지
```

#### 바텀 네비게이션 설계

```jsx
// 모바일 바텀 네비게이션 구조
<nav className="bottom-nav">
    <button className="nav-item active">
        <span className="nav-icon">🏠</span>
        <span className="nav-label">홈</span>
    </button>
    <button className="nav-item">
        <span className="nav-icon">📚</span>
        <span className="nav-label">피드</span>
    </button>
    <button className="nav-item primary">
        <span className="nav-icon">✨</span>
        <span className="nav-label">리딩</span>
    </button>
    <button className="nav-item">
        <span className="nav-icon">👤</span>
        <span className="nav-label">마이</span>
    </button>
</nav>
```

### C.4 CSS 변수 기반 반응형 시스템

```css
/* src/styles/base/variables-responsive.css */

:root {
    /* ========== Breakpoints ========== */
    --breakpoint-mobile: 640px;
    --breakpoint-tablet: 768px;
    --breakpoint-desktop: 1024px;
    --breakpoint-wide: 1200px;

    /* ========== Spacing (모바일 기준) ========== */
    --spacing-xs: 4px;
    --spacing-sm: 8px;
    --spacing-md: 16px;
    --spacing-lg: 24px;
    --spacing-xl: 32px;

    /* ========== 터치 타겟 ========== */
    --touch-target-min: 44px;
    --touch-target-comfortable: 48px;

    /* ========== 타이포그래피 (모바일) ========== */
    --font-size-xs: 12px;
    --font-size-sm: 14px;
    --font-size-base: 16px;   /* 모바일 기본 */
    --font-size-lg: 18px;
    --font-size-xl: 20px;
    --font-size-2xl: 24px;
    --font-size-3xl: 30px;

    /* ========== 레이아웃 ========== */
    --header-height: 56px;
    --bottom-nav-height: 64px;
    --sidebar-width: 0px;      /* 모바일: 사이드바 없음 */
    --content-max-width: 100%;
    --content-padding: var(--spacing-md);

    /* ========== Z-index ========== */
    --z-bottom-nav: 100;
    --z-header: 200;
    --z-modal: 300;
    --z-toast: 400;
    --z-tooltip: 500;

    /* ========== 애니메이션 ========== */
    --transition-fast: 150ms ease;
    --transition-normal: 250ms ease;
    --transition-slow: 350ms ease;

    /* ========== Safe Area (노치 대응) ========== */
    --safe-area-top: env(safe-area-inset-top, 0px);
    --safe-area-bottom: env(safe-area-inset-bottom, 0px);
    --safe-area-left: env(safe-area-inset-left, 0px);
    --safe-area-right: env(safe-area-inset-right, 0px);
}

/* 태블릿 */
@media (min-width: 768px) {
    :root {
        --header-height: 64px;
        --bottom-nav-height: 0px;  /* 태블릿+: 바텀 네비 숨김 */
        --sidebar-width: 280px;
        --content-padding: var(--spacing-lg);
    }
}

/* 데스크탑 */
@media (min-width: 1024px) {
    :root {
        --sidebar-width: 280px;
        --content-max-width: 1200px;
        --content-padding: var(--spacing-xl);
    }
}
```

### C.5 컴포넌트별 모바일 최적화

#### 카드 뷰어

```
데스크탑: 16:9 비율, 좌우 여백 있음
모바일: 9:16 비율, 풀스크린, 스와이프 넘기기

┌─────────────────────────┐
│                         │
│     ┌─────────────┐     │
│     │             │     │
│     │  이미지      │     │
│     │  (9:16)     │     │
│     │             │     │
│     │             │     │
│     └─────────────┘     │
│                         │
│  < 이전  ● ● ○ ○  다음 > │
│                         │
└─────────────────────────┘
```

#### 모달 → 풀스크린 시트

```
데스크탑: 센터 모달 (max-width: 480px)
모바일: 바텀에서 슬라이드업 풀스크린 시트

┌─────────────────────────┐
│  ─────  (드래그 핸들)    │
├─────────────────────────┤
│                         │
│  시트 콘텐츠              │
│                         │
│                         │
│                         │
│  ┌─────────────────────┐│
│  │     확인 버튼        ││
│  └─────────────────────┘│
└─────────────────────────┘
```

#### 입력 폼

```css
/* 모바일 입력 최적화 */
input, textarea, select {
    font-size: 16px;           /* iOS 확대 방지 */
    min-height: var(--touch-target-min);
    padding: var(--spacing-sm) var(--spacing-md);
}

/* 키보드 대응 */
.form-container {
    padding-bottom: calc(var(--spacing-xl) + var(--safe-area-bottom));
}

/* 날짜 입력 (사주용) */
input[type="date"] {
    -webkit-appearance: none;
    appearance: none;
}
```

### C.6 성능 최적화

#### 이미지 최적화

```jsx
// 반응형 이미지 컴포넌트
const ResponsiveImage = ({ src, alt, sizes }) => (
    <picture>
        <source
            media="(max-width: 640px)"
            srcSet={`${src}?w=640&format=webp`}
            type="image/webp"
        />
        <source
            media="(max-width: 1024px)"
            srcSet={`${src}?w=1024&format=webp`}
            type="image/webp"
        />
        <img
            src={src}
            alt={alt}
            loading="lazy"
            decoding="async"
        />
    </picture>
);
```

#### 번들 최적화

```javascript
// vite.config.js
export default {
    build: {
        rollupOptions: {
            output: {
                manualChunks: {
                    'vendor-react': ['react', 'react-dom'],
                    'vendor-firebase': ['firebase/app', 'firebase/firestore'],
                    'vendor-ui': ['framer-motion']
                }
            }
        }
    }
};
```

### C.7 PWA 설정

```json
// public/manifest.json
{
    "name": "점AI - AI 타로 · 꿈해몽 · 사주",
    "short_name": "점AI",
    "description": "AI 기반 타로, 꿈해몽, 사주 서비스",
    "start_url": "/",
    "display": "standalone",
    "background_color": "#0a0a1a",
    "theme_color": "#9b59b6",
    "orientation": "portrait",
    "icons": [
        {
            "src": "/icons/icon-192.png",
            "sizes": "192x192",
            "type": "image/png"
        },
        {
            "src": "/icons/icon-512.png",
            "sizes": "512x512",
            "type": "image/png"
        },
        {
            "src": "/icons/icon-maskable.png",
            "sizes": "512x512",
            "type": "image/png",
            "purpose": "maskable"
        }
    ]
}
```

### C.8 구현 로드맵

```
┌─────────────────────────────────────────────────────────────┐
│  Phase 10 구현 순서                                          │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  Step 1: 기반 작업 (1-2일)                                   │
│  ─────────────────────────                                  │
│  • CSS 변수 시스템 구축 (variables-responsive.css)           │
│  • viewport meta 최적화                                      │
│  • 브레이크포인트 표준화                                      │
│                                                             │
│  Step 2: 레이아웃 재구성 (2-3일)                              │
│  ─────────────────────────                                  │
│  • 모바일 단일 컬럼 레이아웃                                  │
│  • 바텀 네비게이션 구현                                       │
│  • 피드 바텀시트 구현                                         │
│  • 네비게이션 바 모바일 최적화                                │
│                                                             │
│  Step 3: 터치 최적화 (1-2일)                                  │
│  ─────────────────────────                                  │
│  • 터치 타겟 44px 이상 적용                                   │
│  • hover 상태 @media (hover: none) 처리                      │
│  • 터치 피드백 추가                                          │
│                                                             │
│  Step 4: 컴포넌트 최적화 (2-3일)                              │
│  ─────────────────────────                                  │
│  • 카드 뷰어 풀스크린 + 스와이프                              │
│  • 모달 → 바텀시트 전환                                      │
│  • 입력 폼 키보드 대응                                        │
│  • Skeleton UI 추가                                          │
│                                                             │
│  Step 5: 성능 최적화 (1-2일)                                  │
│  ─────────────────────────                                  │
│  • 이미지 lazy loading                                       │
│  • 번들 분할 (code splitting)                                │
│  • 폰트 최적화 (preload, font-display)                       │
│                                                             │
│  Step 6: PWA (1일)                                           │
│  ─────────────────────────                                  │
│  • manifest.json 생성                                        │
│  • Service Worker 기본 설정                                  │
│  • A2HS 배너 구현                                            │
│                                                             │
│  총 예상 기간: 8-13일                                         │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### C.9 테스트 체크리스트

```
모바일 테스트 체크리스트:
─────────────────────────

[ ] 기기별 테스트
    [ ] iPhone SE (소형)
    [ ] iPhone 14/15 (표준)
    [ ] iPhone 14 Pro Max (대형)
    [ ] Galaxy S21 (Android)
    [ ] iPad (태블릿)

[ ] 레이아웃 테스트
    [ ] 가로 스크롤 없음
    [ ] 오버레이/겹침 없음
    [ ] 노치/펀치홀 영역 대응
    [ ] 세로/가로 회전 대응

[ ] 터치 테스트
    [ ] 모든 버튼 44px 이상
    [ ] 실수 터치 방지 간격
    [ ] 스와이프 제스처 동작
    [ ] 더블탭 확대 방지

[ ] 입력 테스트
    [ ] 키보드 오픈 시 레이아웃
    [ ] 포커스 시 스크롤 위치
    [ ] 자동완성 동작
    [ ] 날짜/시간 피커

[ ] 성능 테스트
    [ ] Lighthouse 모바일 점수 90+
    [ ] FCP < 1.8s
    [ ] LCP < 2.5s
    [ ] CLS < 0.1

[ ] PWA 테스트
    [ ] 홈 화면 추가 동작
    [ ] 앱 아이콘 표시
    [ ] 스플래시 화면
    [ ] 오프라인 폴백
```
