/* ========== Bottom Navigation (Mobile Only) ========== */
.bottom-nav {
    display: none; /* 기본적으로 숨김 (데스크탑) */
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    height: 52px; /* 컴팩트 높이 - YouTube 스타일 */
    min-height: 52px;
    max-height: 52px;
    /* iOS 스크롤 버그 방지: 불투명 배경 사용 */
    background: #0a0a0a;
    border-top: 1px solid rgba(255, 255, 255, 0.08);
    padding-bottom: env(safe-area-inset-bottom, 0px);
    z-index: var(--z-sticky);
    justify-content: space-around;
    align-items: center;
    flex-shrink: 0;
    /* GPU 가속으로 스크롤 시 렌더링 안정화 */
    transform: translateZ(0);
    -webkit-transform: translateZ(0);
    will-change: transform;
}

/* 모바일에서만 표시 */
@media (max-width: 768px) {
    .bottom-nav {
        display: flex;
    }

    /* 바텀 네비가 있을 때 메인 콘텐츠 하단 여백 */
    .main-layout {
        padding-bottom: calc(var(--bottom-nav-height) + var(--safe-area-bottom));
    }
}

.bottom-nav-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 1px;
    flex: 1;
    height: 52px;
    min-height: 52px;
    max-height: 52px;
    background: transparent;
    border: none;
    color: var(--light-gray);
    cursor: pointer;
    transition: var(--transition-fast);
    -webkit-tap-highlight-color: transparent;
    min-width: var(--touch-target-min);
    padding: 4px 0;
    flex-shrink: 0;
}

.bottom-nav-item:active {
    transform: scale(0.95);
}

.bottom-nav-item.active {
    color: var(--purple);
}

.bottom-nav-item.active:not(.center-btn) .bottom-nav-icon {
    transform: scale(1.1);
}

.bottom-nav-icon {
    font-size: 1.25rem;
    line-height: 1;
    transition: var(--transition-fast);
}

.bottom-nav-label {
    font-size: 0.6rem;
    font-weight: 500;
    letter-spacing: -0.02em;
}

/* Haptic feedback visual indicator */
.bottom-nav-item:active .bottom-nav-icon {
    transform: scale(0.9);
}

/* Active indicator dot - 제거됨 */

/* ========== 모드 토글 패널 ========== */
.mode-toggle-panel {
    display: none; /* 기본 숨김 (데스크탑) */
    position: fixed;
    bottom: calc(var(--bottom-nav-height) + var(--safe-area-bottom) + 8px);
    left: 50%;
    transform: translateX(-50%);
    z-index: calc(var(--z-sticky) + 1);
    animation: togglePanelSlideUp 0.2s ease-out;
}

@keyframes togglePanelSlideUp {
    from {
        opacity: 0;
        transform: translateX(-50%) translateY(10px);
    }
    to {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
    }
}

@media (max-width: 768px) {
    .mode-toggle-panel {
        display: block;
    }
}

.mode-toggle-tabs {
    display: flex;
    gap: 0;
    background: rgba(0, 0, 0, 0.85);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border-radius: 16px;
    padding: 5px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
}

.mode-toggle-tab {
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: center;
    gap: 6px;
    padding: 0.7rem 1.1rem;
    background: transparent;
    border: none;
    border-radius: 12px;
    color: rgba(255, 255, 255, 0.5);
    font-size: 0.85rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.25s ease;
    white-space: nowrap;
}

.mode-toggle-tab:hover:not(.active) {
    color: rgba(255, 255, 255, 0.7);
    background: rgba(255, 255, 255, 0.05);
}

/* 타로 탭 활성화 - 파스텔 라벤더 그라디언트 */
.mode-toggle-tab.active[data-mode="tarot"] {
    color: #1a1625;
    background: linear-gradient(135deg, #7c8dff 0%, #a78bfa 50%, #c4b5fd 100%);
    border: 1px solid rgba(196, 181, 253, 0.4);
    box-shadow: 0 4px 15px rgba(167, 139, 250, 0.3);
}

/* 꿈 탭 활성화 - 파스텔 민트 그라디언트 */
.mode-toggle-tab.active[data-mode="dream"] {
    color: #0a1f1a;
    background: linear-gradient(135deg, #6ee7b7 0%, #a7f3d0 50%, #d1fae5 100%);
    border: 1px solid rgba(167, 243, 208, 0.4);
    box-shadow: 0 4px 15px rgba(110, 231, 183, 0.25);
}

/* 운세 탭 활성화 - 파스텔 피치 그라디언트 */
.mode-toggle-tab.active[data-mode="fortune"] {
    color: #1f0a0a;
    background: linear-gradient(135deg, #fca5a5 0%, #fcd5ce 50%, #ffecd2 100%);
    border: 1px solid rgba(252, 213, 206, 0.4);
    box-shadow: 0 4px 15px rgba(252, 165, 165, 0.25);
}

.mode-toggle-emoji {
    font-size: 1rem;
    line-height: 1;
}

.mode-toggle-label {
    font-weight: 600;
    font-size: 0.85rem;
    line-height: 1;
}

/* 중앙 시작 버튼 (플로팅 스타일) */
.bottom-nav-item.center-btn {
    position: relative;
    flex: 1.2;
}

.bottom-nav-item.center-btn .center-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 44px;
    height: 44px;
    min-width: 44px;
    min-height: 44px;
    aspect-ratio: 1;
    flex-shrink: 0;
    background: linear-gradient(135deg, #9b59b6 0%, #e056fd 100%);
    border-radius: 50%;
    font-size: 1.15rem;
    margin-top: -24px; /* 50% 위로 올림 - border-top에 중앙 정렬 */
    box-shadow: 0 4px 15px rgba(155, 89, 182, 0.5);
    transition: box-shadow 0.25s ease, background 0.25s ease;
}

/* 시작 버튼 이모지 틸트 애니메이션 (수정 구슬처럼) */
.bottom-nav-item.center-btn .center-icon .start-emoji {
    display: inline-block;
    animation: emojiTilt 4s ease-in-out infinite;
}

@keyframes emojiTilt {
    0%, 100% { transform: rotate(0deg); }
    25% { transform: rotate(10deg); }
    50% { transform: rotate(0deg); }
    75% { transform: rotate(-10deg); }
}

/* ========== 모드별 시작 버튼 그라디언트 (Vivid 버전) ========== */
/* 타로 - 비비드 블루/바이올렛 */
.bottom-nav-item.center-btn.mode-tarot .center-icon {
    background: linear-gradient(135deg, #3b82f6 0%, #6366f1 50%, #8b5cf6 100%);
    box-shadow: 0 4px 18px rgba(99, 102, 241, 0.5);
}

.bottom-nav-item.center-btn.mode-tarot .bottom-nav-label {
    color: #818cf8;
}

/* 꿈 - 비비드 틸/시안 */
.bottom-nav-item.center-btn.mode-dream .center-icon {
    background: linear-gradient(135deg, #0891b2 0%, #0d9488 50%, #14b8a6 100%);
    box-shadow: 0 4px 18px rgba(20, 184, 166, 0.5);
}

.bottom-nav-item.center-btn.mode-dream .bottom-nav-label {
    color: #2dd4bf;
}

/* 사주 - 비비드 앰버/오렌지 */
.bottom-nav-item.center-btn.mode-fortune .center-icon {
    background: linear-gradient(135deg, #ea580c 0%, #f59e0b 50%, #fbbf24 100%);
    box-shadow: 0 4px 18px rgba(245, 158, 11, 0.5);
}

.bottom-nav-item.center-btn.mode-fortune .bottom-nav-label {
    color: #fbbf24;
}

.bottom-nav-item.center-btn:active .center-icon {
    transform: scale(0.92);
}

/* 모드별 active 버튼 glow */
.bottom-nav-item.center-btn.active.mode-tarot .center-icon {
    box-shadow: 0 4px 20px rgba(99, 102, 241, 0.6);
}

.bottom-nav-item.center-btn.active.mode-dream .center-icon {
    box-shadow: 0 4px 20px rgba(20, 184, 166, 0.6);
}

.bottom-nav-item.center-btn.active.mode-fortune .center-icon {
    box-shadow: 0 4px 20px rgba(251, 191, 36, 0.6);
}

.bottom-nav-item.center-btn .bottom-nav-label {
    margin-top: 0; /* 다른 라벨과 수평 정렬 */
    font-weight: 600;
}

/* ========== 분석 중 상태 ========== */
.bottom-nav-item.center-btn.analyzing .center-icon {
    position: relative;
}

/* 타로 분석 중 - 블루/바이올렛 펄스 */
.bottom-nav-item.center-btn.analyzing.mode-tarot .center-icon {
    animation: analyzing-pulse-tarot 1.5s ease-in-out infinite;
}

@keyframes analyzing-pulse-tarot {
    0%, 100% { box-shadow: 0 4px 15px rgba(99, 102, 241, 0.5); }
    50% { box-shadow: 0 4px 25px rgba(99, 102, 241, 0.8), 0 0 40px rgba(139, 92, 246, 0.4); }
}

/* 꿈 분석 중 - 틸 펄스 */
.bottom-nav-item.center-btn.analyzing.mode-dream .center-icon {
    animation: analyzing-pulse-dream 1.5s ease-in-out infinite;
}

@keyframes analyzing-pulse-dream {
    0%, 100% { box-shadow: 0 4px 15px rgba(20, 184, 166, 0.5); }
    50% { box-shadow: 0 4px 25px rgba(20, 184, 166, 0.8), 0 0 40px rgba(45, 212, 191, 0.4); }
}

/* 사주 분석 중 - 앰버 펄스 */
.bottom-nav-item.center-btn.analyzing.mode-fortune .center-icon {
    animation: analyzing-pulse-fortune 1.5s ease-in-out infinite;
}

@keyframes analyzing-pulse-fortune {
    0%, 100% { box-shadow: 0 4px 15px rgba(251, 191, 36, 0.5); }
    50% { box-shadow: 0 4px 25px rgba(251, 191, 36, 0.8), 0 0 40px rgba(252, 211, 77, 0.4); }
}

.bottom-nav-item.center-btn.analyzing .analyzing-icon {
    animation: analyzing-spin 2s linear infinite;
}

@keyframes analyzing-spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* 진행률 링 */
.progress-ring {
    position: absolute;
    top: -4px;
    left: -4px;
    width: 52px;
    height: 52px;
    transform: rotate(-90deg);
    pointer-events: none;
}

.progress-ring-bg {
    stroke: rgba(255, 255, 255, 0.15);
}

.progress-ring-fill {
    stroke-linecap: round;
    transition: stroke-dashoffset 0.3s ease;
    filter: drop-shadow(0 0 6px rgba(255, 0, 85, 0.5))
            drop-shadow(0 0 8px rgba(255, 215, 0, 0.4))
            drop-shadow(0 0 10px rgba(0, 212, 255, 0.3));
}

/* 분석 완료 상태 - blue/purple gradient with glow */
.bottom-nav-item.center-btn.complete .center-icon {
    background: linear-gradient(135deg, #00d9ff 0%, #9b59b6 50%, #667eea 100%);
    box-shadow:
        0 4px 20px rgba(0, 217, 255, 0.5),
        0 0 30px rgba(155, 89, 182, 0.4),
        inset 0 0 10px rgba(255, 255, 255, 0.15);
    border: 2px solid rgba(0, 217, 255, 0.5);
}

/* 완료 상태 라벨 - 밝은 색상 */
.bottom-nav-item.center-btn.complete .bottom-nav-label {
    color: #00d9ff;
    font-weight: 600;
    text-shadow: 0 0 10px rgba(0, 217, 255, 0.5);
}

/* 분석 중 라벨 스타일 */
.bottom-nav-item.center-btn.analyzing .bottom-nav-label {
    color: #ffd700;
    font-weight: 600;
}

/* 가로 모드 대응 */
@media (max-width: 768px) and (orientation: landscape) {
    .bottom-nav {
        height: 48px;
        min-height: 48px;
        max-height: 48px;
    }

    .bottom-nav-item {
        height: 48px;
        min-height: 48px;
        max-height: 48px;
    }

    .bottom-nav-icon {
        font-size: 1.1rem;
    }

    .bottom-nav-label {
        font-size: 0.55rem;
    }

    .bottom-nav-item.center-btn .center-icon {
        width: 38px;
        height: 38px;
        min-width: 38px;
        min-height: 38px;
        font-size: 1rem;
        margin-top: -20px;
    }
}
